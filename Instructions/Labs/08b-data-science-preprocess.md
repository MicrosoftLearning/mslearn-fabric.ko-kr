---
lab:
  title: Microsoft Fabric에서 데이터 랭글러를 사용하여 데이터 전처리
  module: Preprocess data with Data Wrangler in Microsoft Fabric
---

# Notebook을 사용하여 Microsoft Fabric에서 모델 학습

이 랩에서는 Microsoft Fabric의 데이터 랭글러를 사용하여 데이터를 전처리하고 일반적인 데이터 과학 작업 라이브러리를 사용하여 코드를 생성하는 방법을 알아봅니다.

이 랩을 완료하는 데 약 **30**분이 걸립니다.

> **참고**: 이 연습을 완료하려면 Microsoft Fabric 라이선스가 필요합니다. 무료 [Fabric](https://learn.microsoft.com/fabric/get-started/fabric-trial) 평가판 라이선스를 사용하도록 설정하는 방법에 대한 자세한 내용은 Fabric 시작을 참조하세요. 이 작업을 수행하려면 Microsoft *학교* 또는 *회사* 계정이 필요합니다. 없는 경우 [Microsoft Office 365 E3 이상의 평가판에 등록](https://www.microsoft.com/microsoft-365/business/compare-more-office-365-for-business-plans)할 수 있습니다.

## 작업 영역 만들기

패브릭에서 데이터를 사용하기 전에 패브릭 평가판을 사용하도록 설정된 작업 영역을 만듭니다.

1. Microsoft Fabric에 로그인[하고 Power BI**를 선택합니다**.`https://app.fabric.microsoft.com`](https://app.fabric.microsoft.com)
2. 왼쪽 메뉴 모음에서 **작업 영역**을 선택합니다(아이콘은 와 유사함).
3. 선택한 이름으로 새 작업 영역을 만들고 패브릭 용량(*평가판*, *프리미엄* 또는 *패브릭*)이 포함된 라이선스 모드를 선택합니다.
4. 새 작업 영역이 열리면 다음과 같이 비어 있어야 합니다.

    ![Power BI의 빈 작업 영역 스크린샷](./Images/new-workspace.png)

## Lakehouse 만들기 및 파일 업로드

이제 작업 영역이 있으므로 포털에서 데이터 과학* 환경으로 전환*하고 분석하려는 데이터 파일에 대한 데이터 레이크하우스를 만들어야 합니다.

1. Power BI 포털의 왼쪽 아래에서 Power BI 아이콘을 **선택하고 데이터 엔지니어 환경**으로 **전환**합니다.
1. **데이터 엔지니어링** 홈페이지에서 원하는 이름의 새 **레이크하우스**를 만듭니다.

    1분 정도 지나면 테이블**이나 **파일이** 없는 **새 레이크하우스가 만들어집니다. 분석을 위해 데이터 레이크하우스에 일부 데이터를 수집해야 합니다. 이 작업을 수행하는 방법에는 여러 가지가 있지만, 이 연습에서는 로컬 컴퓨터(또는 해당하는 경우 랩 VM)의 텍스트 파일 폴더를 다운로드하여 추출한 다음 레이크하우스에 업로드하기만 하면 됩니다.

1. TODO: 이 연습[https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/XXXXX.csv](https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/XXXXX.csv)에 `dominicks_OJ.csv` 대한 CSV 파일을 다운로드하여 저장합니다.


1. 레이크하우스가 포함된 웹 브라우저 탭으로 돌아가서 Lake 보기** 창의 **파일** 노드에 **대한 **...** 메뉴에서 파일** 업로드** 및 **업로드를 선택한 **다음, 로컬 컴퓨터(또는 해당하는 경우 랩 VM)의 dominicks_OJ.csv** 파일을 Lakehouse에 업로드**합니다.
6. 파일이 업로드된 후 파일을** 확장하고 **CSV 파일이 업로드되었는지 확인합니다.

## Notebook 만들기

모델을 학습하려면 Notebook*을 *만들 수 있습니다. Notebook은 여러 언어로 코드를 작성하고 실험*으로 *실행할 수 있는 대화형 환경을 제공합니다.

1. Power BI 포털의 왼쪽 아래에서 데이터 엔지니어링 아이콘을 **선택하고 데이터 과학** 환경으로 **전환**합니다.

1. **데이터 과학** 홈페이지에서 새 **Notebook**을 만듭니다.

    몇 초 후에 단일 *셀* 이 포함된 새 Notebook이 열립니다. Notebook은 코드 또는 markdown *(서식이 지정된 텍스트)을 포함*할 수 있는 하나 이상의 셀로 구성*됩니다.*

1. 첫 번째 셀(현재 코드* 셀)을 *선택한 다음 오른쪽 위에 있는 동적 도구 모음에서 M&#8595;** 단추를 사용하여 **셀을 markdown* 셀로 *변환합니다.

    셀이 markdown 셀로 변경되면 포함된 텍스트가 렌더링됩니다.

1. **&#128393;**(편집) 단추를 사용하여 셀을 편집 모드로 전환한 다음 콘텐츠를 삭제하고 다음 텍스트를 입력합니다.

    ```text
   # Train a machine learning model and track with MLflow

   Use the code in this notebook to train and track models.
    ``` 

## 데이터 프레임에 데이터 로드

이제 코드를 실행하여 데이터를 준비하고 모델을 학습할 준비가 되었습니다. 데이터를 사용하려면 데이터 프레임을* 사용합니다*. Spark의 데이터 프레임은 Python의 Pandas 데이터 프레임과 유사하며 행 및 열에서 데이터를 사용하기 위한 일반적인 구조를 제공합니다.

1. **레이크하우스** 추가 창에서 추가**를 선택하여 **레이크하우스를 추가합니다.
1. 기존 레이크하우스**를 선택하고 **추가**를 선택합니다**.
1. 이전 섹션에서 만든 레이크하우스를 선택합니다.
1. **CSV 파일이 Notebook 편집기 옆에 나열되도록 파일** 폴더를 확장합니다.
1. churn.csv ...** 메뉴에서 데이터** > **Pandas 로드를** 선택합니다.******** 다음 코드를 포함하는 새 코드 셀을 Notebook에 추가해야 합니다.

    ```python
    import pandas as pd
    df = pd.read_csv("/lakehouse/default/" + "Files/dominicks_OJ.csv") 
    display(df.head(5))
    ```

    > **팁**: 아이콘을 사용하여 **<<** 왼쪽에 있는 파일이 포함된 창을 숨길 수 있습니다. 이렇게 하면 전자 필기장을 집중하게 됩니다.

1. 사용 하 여 **는 &#9655; 셀 왼쪽의 셀** 단추를 실행하여 실행합니다.

    > **참고**: 이 세션에서 Spark 코드를 처음 실행했으므로 Spark 풀을 시작해야 합니다. 즉, 세션의 첫 번째 실행을 완료하는 데 1분 정도 걸릴 수 있습니다. 후속 실행은 더 빨라질 것입니다.

## 요약 통계 보기

데이터 랭글러가 시작되면 요약 패널에서 데이터 프레임에 대한 설명적인 개요가 생성됩니다. 

1. 위쪽 메뉴에서 데이터를 선택한 **다음 **데이터 랭글러** 드롭다운을 선택하여 데이터 세트를 찾 `df` 습니다.**

    ![데이터 랭글러 시작 옵션의 스크린샷.](./Images/launch-data-wrangler.png)

1. **큰 HH** 열을 선택하고 이 기능의 데이터 분포를 얼마나 쉽게 확인할 수 있는지 확인합니다.

    ![특정 열의 데이터 분포를 보여 주는 데이터 랭글러 페이지의 스크린샷.](./Images/data-wrangler-distribution.png)

    이 기능은 일반 배포를 따릅니다.

1. 요약 측면 패널을 확인하고 백분위수 범위를 확인합니다. 

    ![요약 패널 세부 정보를 보여 주는 데이터 랭글러 페이지의 스크린샷.](./Images/data-wrangler-summary.png)

    대부분의 데이터는 0.098**에서 **0.132** 사이**이며 데이터 값의 50%가 해당 범위에 속한다는 것을 알 수 있습니다.

## 텍스트 데이터 서식 지정

이제 브랜드** 기능에 몇 가지 변환을 **적용해 보겠습니다.

1. **데이터 랭글러** 페이지에서 기능을 선택합니다`Brand`.

1. 작업 패널로 **이동하여 찾기 및 바꾸기**를 확장**한 다음 찾기 및 바꾸기**를 선택합니다**.**

1. 찾기 및 바꾸기** 패널에서 **다음 속성을 변경합니다.
    
    - **이전 값:** "."
    - **새 값:** " " (공백 문자)

    ![찾기 및 바꾸기 패널을 보여 주는 데이터 랭글러 페이지의 스크린샷.](./Images/data-wrangler-find.png)

    디스플레이 그리드에서 자동으로 미리 보기된 작업의 결과를 볼 수 있습니다.

1. **적용**을 선택합니다.

1. 작업 패널로 **돌아가서 서식을** 확장 **합니다**.

1. 텍스트를 대문**자로 변환을 선택합니다**.

1. **텍스트를 대**문자로 변환 패널에서 적용**을 선택합니다**.

1. Notebook**에 코드 추가를 선택합니다**. 또한 변환된 데이터 세트를 .csv 파일로 저장할 수도 있습니다.

    코드는 전자 필기장 셀에 자동으로 복사되며 사용할 준비가 된 것입니다.

1. 코드를 실행합니다.

> **중요:** 생성된 코드는 원래 데이터 프레임을 덮어쓰지 않습니다. 

데이터 랭글러 작업을 사용하여 코드를 쉽게 생성하고 텍스트 데이터를 조작하는 방법을 알아보았습니다. 

## 원 핫 인코더 변환 적용

이제 전처리 단계로 원 핫 인코더 변환을 적용하는 코드를 생성해 보겠습니다.

1. 위쪽 메뉴에서 데이터를 선택한 **다음 **데이터 랭글러** 드롭다운을 선택하여 데이터 세트를 찾 `df` 습니다.**

1. 작업** 패널에서 **수식을 확장**합니다**.

1. 원 핫 인코딩**을 선택합니다**.

1. **원 핫 인코딩** 패널에서 적용**을 선택합니다**.

    데이터 랭글러 표시 눈금의 끝으로 이동합니다. 세 가지 새로운 기능을 추가하고 기능을 제거했습니다 `Brand` .

1. Notebook**에 코드 추가를 선택합니다**.

1. 코드를 실행합니다.

## 정렬 및 필터링 작업

1. 위쪽 메뉴에서 데이터를 선택한 **다음 **데이터 랭글러** 드롭다운을 선택하여 데이터 세트를 찾 `df` 습니다.**

1. 작업 패널에서 **정렬 및 필터**를 확장**합니다**.

1. 필터를** 선택합니다**.

1. 필터** 패널에서 **다음 조건을 추가합니다.
    
    - **대상 colunm:** Store
    - **작업:** 같음
    - **값**: 2

1. **적용**을 선택합니다.

    데이터 랭글러의 변경 내용이 그리드를 표시합니다.

1. 작업 패널로 **돌아가서 정렬 및 필터링**을 확장**합니다**.

1. 값 정렬 선택 ****

1. 가격** 패널에서 **다음 조건을 추가합니다.
    
    - **열 이름:** 가격
    - **정렬 순서:** 내림차순

1. **적용**을 선택합니다.

    데이터 랭글러의 변경 내용이 그리드를 표시합니다.

## 데이터 집계

1. 작업 패널로 **돌아가서 그룹화 기준 및 집계**를 선택합니다**.**

1. **그룹화할 열:** 속성에서 `Store` 기능을 선택합니다.

1. 집계** 추가를 선택합니다**.

1. **속성을 집계**할 열에서 `Quantity` 기능을 선택합니다.

1. 집계 형식** 속성의 **개수를** 선택합니다**.

1. **적용**을 선택합니다. 

    데이터 랭글러의 변경 내용이 그리드를 표시합니다.

## 단계 찾아보기 및 제거

실수했고 이전 단계에서 만든 집계를 제거해야 한다고 가정합니다. 다음 단계에 따라 제거합니다.

1. 정리 단계** 패널을 **확장합니다.

1. 그룹화 **기준 및 집계** 단계를 선택합니다.

1. 삭제 아이콘을 선택하여 제거합니다.

    ![찾기 및 바꾸기 패널을 보여 주는 데이터 랭글러 페이지의 스크린샷.](./Images/data-wrangler-delete.png)

    > **중요:** 그리드 보기 및 요약은 현재 단계로 제한됩니다.

    변경 내용은 값 정렬** 단계인 **이전 단계에 되돌리기.

1. Notebook**에 코드 추가를 선택합니다**.

1. 코드를 실행합니다.

일부 전처리 작업에 대한 코드를 생성하고 Notebook에 함수로 다시 저장한 다음 필요에 따라 다시 사용하거나 수정할 수 있습니다.

## Notebook 저장 및 Spark 세션 종료

이제 모델링을 위해 데이터 전처리를 마쳤으므로 의미 있는 이름으로 Notebook을 저장하고 Spark 세션을 종료할 수 있습니다.

1. 전자 필기장 메뉴 모음에서 설정** 아이콘을 사용하여 ⚙️ **전자 필기장 설정을 봅니다.
2. **Notebook의 이름을** 데이터 랭글러**를 사용하여 데이터를 전처리하도록 **설정한 다음 설정 창을 닫습니다.
3. Notebook 메뉴에서 세션 중지를 선택하여 **Spark 세션을** 종료합니다.

## 리소스 정리

이 연습에서는 Notebook을 만들고 데이터 랭글러를 사용하여 기계 학습 모델의 데이터를 탐색하고 전처리했습니다.

전처리 단계 탐색을 완료한 경우 이 연습에 대해 만든 작업 영역을 삭제할 수 있습니다.

1. 왼쪽 막대에서 작업 영역의 아이콘을 선택하여 포함된 모든 항목을 봅니다.
2. 도구 모음의 **...** 메뉴에서 **작업 영역 설정**을 선택합니다.
3. **기타** 섹션에서 **이 작업 영역 제거**를 선택합니다.
